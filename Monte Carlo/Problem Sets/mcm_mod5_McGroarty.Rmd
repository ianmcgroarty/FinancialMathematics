---
title: "Problem Set 5"
author: "Ian McGroarty"
date: "01MAR2020"
output:
  html_document:
    df_print: paged
  word_document: default
  pdf_document:
    keep_tex: no
    latex_engine: pdflatex
    fig_width: 6
    fig_height: 8
  header-includes:
    - \usepackage{booktabs}
    - \usepackage{longtable}
    - \usepackage{array}
    - \usepackage{multirow}
    - \usepackage{wrapfig}
    - \usepackage{float}
    - \usepackage{colortbl}
    - \usepackage{pdflscape}
    - \usepackage{tabu}
    - \usepackage{threeparttable}
    - \usepackage{threeparttablex}
    - \usepackage[normalem]{ulem}
    - \usepackage{makecell}
    - \usepackage[table]{xcolor}
---


```{r setup, include=FALSE}
Sys.setenv(HTTP_PROXY = "c1proxy.frb.org:8080")
Sys.setenv(HTTPS_PROXY = "c1proxy.frb.org:8080")
Sys.setenv(SPARK_HOME = "/usr/hdp/current/spark2-client")
Sys.setenv(SPARK_CONF_DIR= "/usr/hdp/current/spark2-client/conf/")

library(knitr)
library(rmarkdown)
library(expm)
library(rmutil)
library(matlib)

knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1 
Apply Inverse Transform Method to Laplace distribution

\begin{align*}
f(x) &= \frac{\lambda}{2}e^{-\lambda |x - \theta} \\
&= e^{-2|x-2} && (\lambda =2, \theta = 2) \\
&= \text{Break into cases for absolute} \\
f(x) &= e^{-2(x-2)} && x>2 \\
f(x) &= e^{2(x-2)} && x<2 \\
& \text{Integrate to find F(x)} \\
f(x) &= 1-\frac{1}{2} \cdot e^{-2x+4)} && x>2 \\
f(x) &= \frac{1}{2} \cdot e^{2x-4)} && x<2 \\
& \text{Inverte by setting = to U} \\
x &= -\frac{1}{2}[log(-2u+2)-4] \\ 
x &= \frac{1}{2}[log(2u)+4] \\
\end{align*}
We see that the two values of X are equally likely so we integrate from 0 to 0.5 and 0.5 to 1 over U. This is demonstrated with R code below. I've also compared the derived distribution to the Laplace distribution generated by the R function *rlaplace* in package *rmutil*

```{r}

Nsim <- 10^4
U <- runif(Nsim , min=0,max=1)

## From the actual Lapace distribution through rmutil package
  # m = theta = 2 & s = 1/lambda = (1/2)
Y <- rlaplace(Nsim, m=2,s=(1/2))

## Generate from the inverse transform method
X <- ifelse(U>.5,(log(-2*(U) + 2)-4)/(-2),
     ifelse(U<.5,(log(2*U)+4)/(2),2))
par(mfrow = c(1,2))
hist(Y,freq=F, main= "Laplace from rmutil")
hist(X,freq=F, main= "Laplace from Uniform")
```

## Problem 2
Let Randomn variable X has pdf:
$$
f(x) = \left\{ 
\begin{align*}
(1/4) && 0 < x < 1 \\
 x-(3/4) && 1 \leq x \leq 2
\end{align*}
\right. 
$$
### (a) Gen a r.v. using inverse transform method
1. First we integrate to find F(x) 
$$
F(x) = \left\{ 
\begin{align*}
\frac{1}{4}x && 0 < x < 1 \\
 \frac{1}{2}x^2-\frac{3}{4}x && 1 \leq x \leq 2
\end{align*}
\right. 
$$
2. Find $F^-(x)$ by setting equal to U and solving for x:
\begin{align*}
x &= 4U \\
x &= \frac{1}{4}( 3 \mp \sqrt{32U + 9})
\end{align*}
3. Using R and a uniform distribution from 0,1 with each x having equal probability for U: (R code and plot provided at the end of the problem)

### (b) Gen a r.v. using the accept reject method 
We don't really need to do any fancy calculations for the max, so observe that:
$$sup(f(x))= x - (3/4) | x=2 \implies x_{opt} = (5/4) \rightarrow M = \frac{f((5/4))}{g((5/4))}=2 $$
The rest is demonstrated in the R code below under PART (b)


```{r}

## PART (a) USING THE INVERSE TRANSFORM METHOD
# Set the number of simulations
  Nsim <- 10^4
# Generate the uniform values to plug into the inverse
  U <- runif(Nsim , min=0,max=1)
# Evaluate the inverse for the Us
  XA <- ifelse(U<(1/2),4*U,(1/4)*(3 + sqrt(32*U + 9)))


## PART (b) USING ACCEPT REJECT
# Set the max    
  M <- (2)
# Set the function
  fx <- function(x){
    ifelse((x<1),(1/4),ifelse((1<=x & x<= 2),x-(3/4),NA))
  }
# Generate x candidates over the range under condiseration
  Xcand <- runif(Nsim,min=0,max=2)
# Generate y candidates up to M
  Ycand <- runif(Nsim, min=0, max=M)
# Keep the x candidates for which the Y candidates are viable solutions
  XB <- Xcand[Ycand < fx(Xcand)]

## Plots for (a) and (b)
hist(XA,freq=F,main="Hist via Inverse transform")
plot(fx,xlim=c(0,2.5),ylim=c(0,2.5),col = "blue",add=TRUE)
hist(XB,freq=F,main="Hist via Accept Reject")
plot(fx,xlim=c(0,2.5),ylim=c(0,2.5),col = "blue",add=TRUE)

```

